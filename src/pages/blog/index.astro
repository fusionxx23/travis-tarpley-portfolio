---
import RootLayout from "../../layouts/RootLayout.astro";
import Header from "../../components/Header.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import { CLOUDFRONT_URL } from "@data/constants";
import { Image } from "astro:assets";
import { getBlogs } from "../../libs/blogs/index.ts";
const safeBlogs = await getBlogs();
---

<RootLayout>
  <div class="pt-[60px]"></div>
  <main class="flex justify-center">
    <section class="">
      <h1 class="text-3xl py-4 text-gray-100 font-semibold">
        My Latest Posts
      </h1>
      <ul class="space-y-8">
        {
          safeBlogs?.map((post) => {
            const arr = post.imageKey.split(".");
            const imageId = arr[0];
            const ext = arr[1];
            return (
              <li
                class="bg-black/30 w-[600px] border-2 border-purple-300/30
                rounded-lg p-4"
              >
                <a class="" href={`/blog/${post.slug}/`}>
                  <div class="flex gap-x-4">
                    <div class="w-[150px]">
                      <Image
                        width={150}
                        height={100}
                        class="object-cover w-[150px] h-[100px]"
                        src={`${CLOUDFRONT_URL}/${imageId}_150x.${ext}`}
                        alt=""
                      />
                    </div>
                    <div class="flex flex-col justify-between gap-y-4">
                      <div>
                        <h4 class="text-2xl font-bold pb-1">
                          {post.title}
                        </h4>
                        <p class="text-gray-400 text-[14px]">
                          {post.description}
                          Lorem ipsum dolor sit, amet
                          consectetur adipisicing elit.
                          Facere
                        </p>
                      </div>
                      <div class="text-gray-300 w-full font-medium text-right text-sm">
                        <p>
                          {Intl.DateTimeFormat("en-US", {
                            year: "numeric",
                            month: "long",
                            day: "numeric",
                          }).format(
                            new Date(
                              parseInt(post.createdAt),
                            ),
                          )}
                        </p>
                      </div>
                    </div>
                  </div>
                </a>
              </li>
            );
          })
        }
      </ul>
    </section>
  </main>
</RootLayout>

<Header />
